

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Handling time &mdash; pySFML 0.9 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="pySFML 0.9 documentation" href="../../index.html" />
    <link rel="up" title="Tutorials" href="../../tutorials.html" />
    <link rel="next" title="Opening a window" href="opening_a_window.html" />
    <link rel="prev" title="Handling events" href="handling_events.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="opening_a_window.html" title="Opening a window"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="handling_events.html" title="Handling events"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">pySFML 0.9 documentation</a> &raquo;</li>
          <li><a href="../../tutorials.html" accesskey="U">Tutorials</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="handling-time">
<h1>Handling time<a class="headerlink" href="#handling-time" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Time is usually not a big thing, but in a real-time application, it is
important to handle it properly, as we will see in this new tutorial.</p>
</div>
<div class="section" id="measuring-time">
<h2>Measuring time<a class="headerlink" href="#measuring-time" title="Permalink to this headline">¶</a></h2>
<p>In SFML, you measure time with sf.Clock class. It defines one function:
<cite>reset()</cite>, to restart the clock, and an property <cite>elapsed_time</cite>, to get
the time elapsed since the last call to <cite>reset()</cite>. Time is defined in
miliseconds, as all durations that you will find in SFML.</p>
<p>As you can see, this class is far from being complicated.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">clock</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>

<span class="n">running</span> <span class="o">=</span> <span class="bp">True</span>
<span class="k">while</span> <span class="n">running</span><span class="p">:</span>
   <span class="c"># process events...</span>

   <span class="c"># get elapsed time since last loop</span>
   <span class="n">time</span> <span class="o">=</span> <span class="n">clock</span><span class="o">.</span><span class="n">elapsed_time</span>
   <span class="n">clock</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

   <span class="c"># display window...</span>
</pre></div>
</div>
<p>Getting elapsed time can be very useful if you have to increment a
variable at each loop (a position, an orientation, ...). If you don&#8217;t
take in account the time factor, your simulation won&#8217;t produce the same
results whether the application runs at 60 frames per seconds or at
1000 frames per seconds. For example, this piece of code will make
movement dependant on framerate</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sleep</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">top</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">while</span> <span class="n">running</span><span class="p">:</span>
   <span class="k">if</span> <span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">is_key_pressed</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">LEFT</span><span class="p">):</span>  <span class="n">left</span> <span class="o">-=</span> <span class="n">speed</span>
   <span class="k">if</span> <span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">is_key_pressed</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">):</span> <span class="n">left</span> <span class="o">+=</span> <span class="n">speed</span>
   <span class="k">if</span> <span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">is_key_pressed</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">UP</span><span class="p">):</span>    <span class="n">top</span>  <span class="o">-=</span> <span class="n">speed</span>
   <span class="k">if</span> <span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">is_key_pressed</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">DOWN</span><span class="p">):</span>  <span class="n">top</span>  <span class="o">-=</span> <span class="n">speed</span>
</pre></div>
</div>
<p>Whereas this one will ensure constant speed on every hardware</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">clock</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>

<span class="n">speed</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">top</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">while</span> <span class="n">running</span><span class="p">:</span>
   <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">clock</span><span class="o">.</span><span class="n">elapsed_time</span>
   <span class="n">clock</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

   <span class="k">if</span> <span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">is_key_pressed</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">LEFT</span><span class="p">):</span>  <span class="n">left</span> <span class="o">-=</span> <span class="n">speed</span> <span class="o">*</span> <span class="n">elapsed_time</span>
   <span class="k">if</span> <span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">is_key_pressed</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">):</span> <span class="n">left</span> <span class="o">+=</span> <span class="n">speed</span> <span class="o">*</span> <span class="n">elapsed_time</span>
   <span class="k">if</span> <span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">is_key_pressed</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">UP</span><span class="p">):</span>    <span class="n">top</span>  <span class="o">-=</span> <span class="n">speed</span> <span class="o">*</span> <span class="n">elapsed_time</span>
   <span class="k">if</span> <span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">is_key_pressed</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">DOWN</span><span class="p">):</span>  <span class="n">top</span>  <span class="o">-=</span> <span class="n">speed</span> <span class="o">*</span> <span class="n">elapsed_time</span>
</pre></div>
</div>
<p>Most of time, you will have to measure the time elapsed since last
frame. sf.Window provides a useful property for getting this time
without having to manage a clock : <cite>frame_time</cite>. So we could rewrite
our code like this</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">speed</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">top</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">while</span> <span class="n">running</span><span class="p">:</span>
   <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">clock</span><span class="o">.</span><span class="n">elapsed_time</span>
   <span class="n">clock</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

   <span class="k">if</span> <span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">is_key_pressed</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">LEFT</span><span class="p">):</span>  <span class="n">left</span> <span class="o">-=</span> <span class="n">speed</span> <span class="o">*</span> <span class="n">window</span><span class="o">.</span><span class="n">frame_time</span>
   <span class="k">if</span> <span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">is_key_pressed</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">):</span> <span class="n">left</span> <span class="o">+=</span> <span class="n">speed</span> <span class="o">*</span> <span class="n">window</span><span class="o">.</span><span class="n">frame_time</span>
   <span class="k">if</span> <span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">is_key_pressed</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">UP</span><span class="p">):</span>    <span class="n">top</span>  <span class="o">-=</span> <span class="n">speed</span> <span class="o">*</span> <span class="n">window</span><span class="o">.</span><span class="n">frame_time</span>
   <span class="k">if</span> <span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">is_key_pressed</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">Keyboard</span><span class="o">.</span><span class="n">DOWN</span><span class="p">):</span>  <span class="n">top</span>  <span class="o">-=</span> <span class="n">speed</span> <span class="o">*</span> <span class="n">window</span><span class="o">.</span><span class="n">frame_time</span>
</pre></div>
</div>
</div>
<div class="section" id="measuring-framerate">
<h2>Measuring framerate<a class="headerlink" href="#measuring-framerate" title="Permalink to this headline">¶</a></h2>
<p>As framerate is the inverse of the duration of one frame, you can
easily deduce it from elapsed time between frames</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">clock</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>

<span class="k">while</span> <span class="n">running</span><span class="p">:</span>
   <span class="n">frame_rate</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">/</span> <span class="n">clock</span><span class="o">.</span><span class="n">elapsed_time</span>
   <span class="n">clock</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

<span class="c"># or ...</span>

<span class="k">while</span> <span class="n">running</span><span class="p">:</span>
   <span class="n">frame_rate</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">/</span> <span class="n">window</span><span class="o">.</span><span class="n">frame_time</span>
</pre></div>
</div>
<p>If your framerate gets stuck around 60 fps don&#8217;t worry : it just means
that vertical synchronization (v-sync) is enabled. Basically, when
v-sync is on, display will be synchronized with the monitor refresh
rate. It means you won&#8217;t be able to display more frames than the
monitor can do. And this is a good thing, as it ensures your
application won&#8217;t run at incredible framerates like 2000 fps, and
produce bad visual artifacts or unpredicted behaviors.</p>
<p>However, you sometimes want to do some benchmark for optimizations, and
you want maximum framerate. SFML allows you to disable vertical
synchronization if you want, with the <a href="#id1"><span class="problematic" id="id2">`</span></a>vertical_synchronization&#8217;
property</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">window</span><span class="o">.</span><span class="n">vertical_synchronization</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>
</div>
<p>Note that vertical synchronization is disabled by default.</p>
<p>You can also set the framerate to a fixed limit</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">window</span><span class="o">.</span><span class="n">framerate_limit</span> <span class="o">=</span> <span class="mi">60</span> <span class="c"># limit to 60 frames per second</span>
<span class="n">window</span><span class="o">.</span><span class="n">framerate_limit</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c"># no limit</span>
</pre></div>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>Time handling has no more secret for you now, and you can start to
write robust real-time applications. In the next tutorial, we&#8217;ll play a
bit with OpenGL, to finally get something to display in our window.
However, if you&#8217;re not interested in using OpenGL with SFML, you can
jump directly to the next section about the graphics package.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/sfml2-logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Handling time</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#measuring-time">Measuring time</a></li>
<li><a class="reference internal" href="#measuring-framerate">Measuring framerate</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="handling_events.html"
                        title="previous chapter">Handling events</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="opening_a_window.html"
                        title="next chapter">Opening a window</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/tutorials/window/handling_time.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="opening_a_window.html" title="Opening a window"
             >next</a> |</li>
        <li class="right" >
          <a href="handling_events.html" title="Handling events"
             >previous</a> |</li>
        <li><a href="../../index.html">pySFML 0.9 documentation</a> &raquo;</li>
          <li><a href="../../tutorials.html" >Tutorials</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Jonathan De Wachter.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>